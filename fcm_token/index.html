<!DOCTYPE html>
<html>
<head>
  <title>FCM Token Test</title>
  <meta charset="utf-8" />
</head>
<body>
  <h3>Check console for FCM token</h3>

  <!-- Firebase v10+ CDN modules -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
    import { getMessaging, getToken, onMessage } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-messaging.js";
  
    const firebaseConfig = {
      apiKey: "AIzaSyBmCH8P_Six_A7_euUZQN5oBS8nqbOv84A",
      authDomain: "push-notification-42ae7.firebaseapp.com",
      projectId: "push-notification-42ae7",
      storageBucket: "push-notification-42ae7.appspot.com",
      messagingSenderId: "63810231131",
      appId: "1:63810231131:web:289a180b352995a0dcd87e",
      measurementId: "G-2KMMQL3ZEQ"
    };
  
    const app = initializeApp(firebaseConfig);
    const messaging = getMessaging(app);
  
    // âœ… Register service worker
    navigator.serviceWorker.register("/firebase-messaging-sw.js")
      .then((registration) => {
        console.log("Service Worker registered:", registration);
  
        // Ask permission & get token
        Notification.requestPermission().then(async (permission) => {
          if (permission === "granted") {
            const token = await getToken(messaging, {
              vapidKey: "BMEWGVLWQ7vaLtGh0LgVO1sAjlS60MJGlwckcC0pmsLQWiUEEGZDpyGgbqaWLAVfYUEjqT4KekT9KmK0fQALFmI",
              serviceWorkerRegistration: registration,
            });
            console.log("âœ… FCM token:", token);
          } else {
            console.warn("Notification permission not granted");
          }
        });
      });
  
    // âœ… Foreground message handler
    onMessage(messaging, (payload) => {
      console.log("ðŸ“© Message received in foreground:", payload);
      const { title, body } = payload.notification;
      new Notification(title, { body });
    });
  </script>
  
</body>
</html>
